---
title: Create Invoice
description: Create a new invoice for token purchase
---

# Create Invoice

Creates a new invoice for purchasing tokens from a seller.

## Endpoint

```
POST /invoices
```

## Request Body

```json
{
  "public_key": "string",
  "signature": "string", 
  "payload": {
    "payment_address": "string",
    "buyer_address": "string",
    "mint_hash": "string",
    "quantity": 100,
    "price": 50000,
    "seller_address": "string"
  }
}
```

### Parameters

- **public_key** (required): Hex-encoded public key for signature verification
- **signature** (required): Hex-encoded DER signature of the payload
- **payload** (required): Invoice details object
  - **payment_address** (required): Dogecoin address where payment should be sent
  - **buyer_address** (required): Address of the token buyer
  - **mint_hash** (required): Hash of the mint for which tokens are being purchased
  - **quantity** (required): Number of tokens to purchase (positive integer)
  - **price** (required): Total price in satoshis (positive integer)
  - **seller_address** (required): Address of the token seller

## Response

### Success (201 Created)

```json
{
  "hash": "abc123def456..."
}
```

### Error Responses

- **400 Bad Request**: Invalid JSON, validation failed, or invoice limit reached
- **500 Internal Server Error**: Server error or gossip failure

## Authentication

This endpoint requires a signed request. The payload must be signed with the private key corresponding to the provided public key.

## Rate Limits

Each user can have a maximum number of unconfirmed invoices per mint (configured by `invoice_limit` in server config).

## Example

### cURL

```bash
curl -X POST "http://localhost:8080/invoices" \
  -H "Content-Type: application/json" \
  -d '{
    "public_key": "03a1b2c3d4e5f6...",
    "signature": "304502210...",
    "payload": {
      "payment_address": "D8X9Y2Z3A4B5C6...",
      "buyer_address": "D1A2B3C4D5E6F7...",
      "mint_hash": "abc123def456...",
      "quantity": 100,
      "price": 50000,
      "seller_address": "D9Z8Y7X6W5V4U3..."
    }
  }'
```

### JavaScript

```javascript
const response = await fetch('/invoices', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    public_key: '03a1b2c3d4e5f6...',
    signature: '304502210...',
    payload: {
      payment_address: 'D8X9Y2Z3A4B5C6...',
      buyer_address: 'D1A2B3C4D5E6F7...',
      mint_hash: 'abc123def456...',
      quantity: 100,
      price: 50000,
      seller_address: 'D9Z8Y7X6W5V4U3...'
    }
  })
});

const invoice = await response.json();
console.log('Invoice hash:', invoice.hash);
```

### Python

```python
import requests

payload = {
    "public_key": "03a1b2c3d4e5f6...",
    "signature": "304502210...",
    "payload": {
        "payment_address": "D8X9Y2Z3A4B5C6...",
        "buyer_address": "D1A2B3C4D5E6F7...", 
        "mint_hash": "abc123def456...",
        "quantity": 100,
        "price": 50000,
        "seller_address": "D9Z8Y7X6W5V4U3..."
    }
}

response = requests.post('http://localhost:8080/invoices', json=payload)
invoice = response.json()
print(f"Invoice hash: {invoice['hash']}")
```

## Notes

- The invoice will be gossiped to other nodes in the network after creation
- Invoices track pending token purchases and facilitate P2P trading
- The signature must be created by signing the JSON payload with the private key
